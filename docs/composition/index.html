<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <base href="/">
  <meta name="description" content="Lightweight functions for developing applications using web components">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>FicusJS documentation - Extending components</title>
  <link rel="stylesheet" href="css/doc.css">
  <link rel="apple-touch-icon" sizes="57x57" href="img/favicons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="img/favicons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="img/favicons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="img/favicons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="img/favicons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="img/favicons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="img/favicons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="img/favicons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="img/favicons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="img/favicons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="img/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="img/favicons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="img/favicons/favicon-16x16.png">
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="img/favicons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<svg style="position:absolute;height:0;width:0;">
  <symbol id="icon_home" viewBox="0 0 32 32">
    <g>
      <path d="M 16 2.59375 L 15.28125 3.28125 L 2.28125 16.28125 L 3.71875 17.71875 L 5 16.4375 L 5 28 L 14 28 L 14 18 L 18 18 L 18 28 L 27 28 L 27 16.4375 L 28.28125 17.71875 L 29.71875 16.28125 L 16.71875 3.28125 Z M 16 5.4375 L 25 14.4375 L 25 26 L 20 26 L 20 16 L 12 16 L 12 26 L 7 26 L 7 14.4375 Z "></path>
    </g>
  </symbol>
  <symbol id="icon_github" viewBox="0 0 32 32">
    <g>
      <path d="M 16 4 C 9.371094 4 4 9.371094 4 16 C 4 21.300781 7.4375 25.800781 12.207031 27.386719 C 12.808594 27.496094 13.027344 27.128906 13.027344 26.808594 C 13.027344 26.523438 13.015625 25.769531 13.011719 24.769531 C 9.671875 25.492188 8.96875 23.160156 8.96875 23.160156 C 8.421875 21.773438 7.636719 21.402344 7.636719 21.402344 C 6.546875 20.660156 7.71875 20.675781 7.71875 20.675781 C 8.921875 20.761719 9.554688 21.910156 9.554688 21.910156 C 10.625 23.746094 12.363281 23.214844 13.046875 22.910156 C 13.15625 22.132813 13.46875 21.605469 13.808594 21.304688 C 11.144531 21.003906 8.34375 19.972656 8.34375 15.375 C 8.34375 14.0625 8.8125 12.992188 9.578125 12.152344 C 9.457031 11.851563 9.042969 10.628906 9.695313 8.976563 C 9.695313 8.976563 10.703125 8.65625 12.996094 10.207031 C 13.953125 9.941406 14.980469 9.808594 16 9.804688 C 17.019531 9.808594 18.046875 9.941406 19.003906 10.207031 C 21.296875 8.65625 22.300781 8.976563 22.300781 8.976563 C 22.957031 10.628906 22.546875 11.851563 22.421875 12.152344 C 23.191406 12.992188 23.652344 14.0625 23.652344 15.375 C 23.652344 19.984375 20.847656 20.996094 18.175781 21.296875 C 18.605469 21.664063 18.988281 22.398438 18.988281 23.515625 C 18.988281 25.121094 18.976563 26.414063 18.976563 26.808594 C 18.976563 27.128906 19.191406 27.503906 19.800781 27.386719 C 24.566406 25.796875 28 21.300781 28 16 C 28 9.371094 22.628906 4 16 4 Z "></path>
    </g>
  </symbol>
</svg>
<div class="doc__bg"></div>
<nav class="header">
  <div class="wrapper">
    <div class="logo">FicusJS <span class="logo__thin">Doc</span></div>
    <ul class="menu">
      <li class="menu__item toggle"><span></span></li>
      <li class="menu__item"><a href="https://github.com/ducksoupdev/ficusjs" target="_blank" rel="noopener noreferrer" class="link link--dark"><svg class="icon"><use xlink:href="#icon_github" /></svg> Github</a></li>
      <li class="menu__item"><a href="index.html" class="link link--dark"><svg class="icon"><use xlink:href="#icon_home" /></svg> Home</a></li>
    </ul>
  </div>
</nav>
<div class="wrapper">
  <div class="wrapper__content">
    <aside class="doc__nav">
      <ul>
        <li class=""><a href="docs/getting-started" class="doc__nav-item">Getting started</a></li>
        <li class=""><a href="docs/installation" class="doc__nav-item">Installation</a></li>
        <li class=""><a href="docs/features" class="doc__nav-item">Features</a></li>
        <li class=""><a href="docs/components" class="doc__nav-item">Components</a></li>
        <li class=""><a href="docs/composition" class="doc__nav-item">Extending components</a></li>
        <li class=""><a href="docs/stores" class="doc__nav-item">Stores</a></li>
        <li class=""><a href="docs/event-bus" class="doc__nav-item">Event bus</a></li>
        <li class=""><a href="docs/modules" class="doc__nav-item">Modules</a></li>
        <li class=""><a href="docs/browser-support" class="doc__nav-item">Browser support</a></li>
        <li class=""><a href="docs/going-build-less" class="doc__nav-item">Going build-less</a></li>
        <li class=""><a href="docs/legacy-browsers" class="doc__nav-item">Legacy browsers</a></li>
        <li class=""><a href="https://github.com/ficusjs/ficusjs/tree/master/examples" target="_blank" rel="noopener noreferrer" class="doc__nav-item">Examples</a></li>
        <li class=""><a href="https://github.com/ficusjs/ficusjs/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="doc__nav-item">Changelog</a></li>
        <li class=""><a href="docs/router" class="doc__nav-item">FicusJS router</a></li>
        <li class=""><a href="docs/script" class="doc__nav-item">FicusJS script loader</a></li>
      </ul>    </aside>
    <article class="doc__content">
      <h1>Extending components</h1>
<p>FicusJS provides a set of functions for extending components.</p>
<p>You can also write your own functions.</p>
<h2><code>withStore</code> function</h2>
<p>The <code>withStore</code> function extends a component and makes working with stores easier in component rendering, computed getters and methods.</p>
<pre><code class="language-js">import { createComponent, withStore } from 'https://unpkg.com/ficusjs?module'

// import the renderer and html tagged template literal from the lit-html library
import { html, renderer } from 'https://unpkg.com/ficusjs-renderers@latest/dist/lit-html.js'

// import a single store or object of stores from a local file
import { store } from './store.js'

createComponent(
  'my-component',
  withStore(store, {
    renderer,
    props: {
      personName: {
        type: String,
        required: true
      }
    },
    render () {
      return html`
        &lt;p&gt;
          ${this.store.state.greeting}, there! My name is ${this.props.personName}
        &lt;/p&gt;
      `
    }
  })
)
</code></pre>
<p>The <code>withStore</code> function provides a <code>this.store</code> property within the component.
It also makes the component reactive to store changes as well as handling automatic store subscriptions based on the component lifecycle hooks.
It will also refresh computed getters when store state changes.</p>
<h3><code>setStore</code> method</h3>
<p>The <code>setStore</code> method can be called when a store instance needs to be set after the component has initialised.
The method accepts a <code>store</code> argument which can be a single store instance or object of store instances.</p>
<pre><code class="language-js">{
  someMethod () {
    const store = getStoreSomehow()
    this.setStore(store)
  }
}
</code></pre>
<h2><code>withEventBus</code> function</h2>
<p>The <code>withEventBus</code> function extends a component and makes working with an event bus easier in component methods.</p>
<pre><code class="language-js">import { createComponent, withEventBus } from 'https://unpkg.com/ficusjs?module'

// import the renderer and html tagged template literal from the lit-html library
import { html, renderer } from 'https://unpkg.com/ficusjs-renderers@latest/dist/lit-html.js'

// import an event bus from a local file
import { eventBus } from './event-bus.js'

createComponent(
  'my-component',
  withEventBus(eventBus, {
    renderer,
    buttonClicked () {
      this.eventBus.publish('increment', undefined)
    },
    render () {
      return html`&lt;button type=&quot;button&quot; @click=${this.buttonClicked}&gt;Increment&lt;/button&gt;`
    }
  })
)
</code></pre>
<p>The <code>withEventBus</code> function provides a <code>this.eventBus</code> property within the component.
It handles automatic event bus subscription based on the component lifecycle hooks.</p>
<h3><code>setEventBus</code> method</h3>
<p>The <code>setEventBus</code> method can be called when an instance needs to be set after the component has initialised.
The method accepts an <code>eventBus</code> argument which is a single event instance.</p>
<pre><code class="language-js">{
  someMethod () {
    const eventBus = getEventBus()
    this.setEventBus(eventBus)
  }
}
</code></pre>
<h2><code>withStateTransactions</code> function</h2>
<p>The <code>withStateTransactions</code> function extends a component with transactions so multiple state changes can occur without triggering a re-render.</p>
<pre><code class="language-js">import { createComponent, withStateTransactions } from 'https://unpkg.com/ficusjs?module'

// import the renderer and html tagged template literal from the lit-html library
import { html, renderer } from 'https://unpkg.com/ficusjs-renderers@latest/dist/lit-html.js'

createComponent(
  'my-like-component',
  withStateTransactions({
    renderer,
    state () {
      return { count: 0, message: null, status: 'unliked' }
    },
    like () {
      // start a transaction
      this.beginTransaction()

      // change some state
      this.state.count = this.state.count + 1
      this.state.message = 'Thanks for liking this!'

      // save the like to the server
      window.fetch('/api/likes', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ count: this.state.count, updatedBy: 'Jane Doe' })
      })
      .then(res =&gt; res.json())
      .then(data =&gt; {
        this.state.status = 'liked'
        this.endTransaction()
      })
      .catch(err =&gt; {
        this.rollbackTransaction()
        this.state.status = 'error'
      })
    },
    render () {
      if (this.state.status === 'liked') {
         return html`&lt;p&gt;${this.state.message}&lt;/p&gt;`
      }
      return html`&lt;button type=&quot;button&quot; @click=${this.like}&gt;Like&lt;/button&gt;`
    }
  })
)
</code></pre>
<p>A transaction is a sequence of operations performed on state as a single logical unit of work.
The transaction can be either all committed (applied to state) or all rolled back (undone from state).</p>
<h3><code>beginTransaction</code> method</h3>
<p>The <code>beginTransaction</code> method starts a transaction.</p>
<h3><code>endTransaction</code> method</h3>
<p>The <code>endTransaction</code> method ends the transaction and triggers a component render.</p>
<h3><code>rollbackTransaction</code> method</h3>
<p>The <code>rollbackTransaction</code> method rolls back the state changes carried out within the transaction.
This is used if an error occurs, and the state needs to be reset.</p>

    </article>
  </div>
</div>
<a href="#" class="cd-top text-replace"></a>

<script src="js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="module" src="js/scribbler.js"></script>
<script src="js/service-worker.js"></script>
</body>
</html>
